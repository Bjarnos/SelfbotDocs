<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>DocsAI Chatbot</title>
<style>
  body { font-family: Arial, sans-serif; margin: 2rem; background: #f0f0f0; }
  #chatbox { 
    border: 1px solid #ccc; 
    padding: 1rem; 
    max-width: 600px; 
    margin: auto; 
    background: white; 
    height: 400px; 
    overflow-y: auto; 
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  .message { margin-bottom: 1rem; }
  .user { text-align: right; color: #0066ff; }
  .bot { text-align: left; color: #008000; }
  #inputArea { 
    max-width: 600px; 
    margin: 1rem auto 0 auto; 
    display: flex; 
  }
  #queryInput { 
    flex: 1; 
    padding: 0.5rem; 
    font-size: 1rem; 
    border: 1px solid #ccc; 
    border-radius: 4px 0 0 4px;
    outline: none;
  }
  #sendBtn { 
    padding: 0.5rem 1rem; 
    font-size: 1rem; 
    background: #0066ff; 
    color: white; 
    border: none; 
    cursor: pointer;
    border-radius: 0 4px 4px 0;
  }
  #sendBtn:disabled {
    background: #aaa;
    cursor: default;
  }
</style>
</head>
<body>
  <div id="chatbox"></div>
  <div id="inputArea">
    <input type="text" id="queryInput" placeholder="Ask me anything..." autocomplete="off" />
    <button id="sendBtn">Send</button>
  </div>

<script>
  const chatbox = document.getElementById("chatbox");
  const queryInput = document.getElementById("queryInput");
  const sendBtn = document.getElementById("sendBtn");

  function addMessage(text, sender) {
    const div = document.createElement("div");
    div.classList.add("message", sender);
    div.textContent = text;
    chatbox.appendChild(div);
    chatbox.scrollTop = chatbox.scrollHeight;
  }

  async function sendQuery() {
    const query = queryInput.value.trim();
    if (!query) return;
    addMessage(query, "user");
    queryInput.value = "";
    sendBtn.disabled = true;
    addMessage("...", "bot");

    try {
      const res = await fetch("https://adorable-ashli-infinitymagicstudios-eafa00db.koyeb.app/ask", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query })
      });
      const data = await res.json();

      chatbox.lastChild.textContent = data.answer || data.error || "No answer.";
    } catch (err) {
      chatbox.lastChild.textContent = "Network error.";
    }
    sendBtn.disabled = false;
    queryInput.focus();
  }

  sendBtn.onclick = sendQuery;
  queryInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") sendQuery();
  });
</script>
</body>
</html>
